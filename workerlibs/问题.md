1. 跨域问题： blob
2. 可用对象：

- Navigator
- XMLHttpRequest
- Array, Date, Math, and String
- WindowTimers.setTimeout (en-US) and WindowTimers.setInterval (en-US)

3. 传参数问题 🌟
可转让对象 http://updates.html5rocks.com/2011/12/Transferable-Objects-Lightning-Fast
ArrayBuffer postMessage() File Blob ArrayBuffer
```ts
worker.postMessage(arrayBuffer, [transferableList]);
window.postMessage(arrayBuffer, targetOrigin, [transferableList]);
```
4. 兼容性问题
   兼容性检测
5. 性能方面
   检测 cpu 数量然后做对应策略
6. 异常处理
7. 学习难度、开发体验

## 专用 worker

```ts
type onerror = (e: {
  message: string // 可读性良好的错误消息。
  filename: string // 发生错误的脚本文件名。
  lineno: string // 发生错误时所在脚本文件的行号。
}) => void
// main.ts
interface Worker {
  postMessage: (...args: any[]) => void
  onmessage: (e: Event) => void
  onerror: onerror
  terminate: () => void
}
var myWorker = new Worker('worker.js')
// worker.js
type self = {
  postMessage: (...args: any[]) => void
  onmessage: (e: Event) => void
  onerror: onerror
  close: () => void
}
```

## 引入脚本与库

```ts
type importScripts = (...paths: string[]) => void
```

## 共享 worker

```ts
var myWorker = new SharedWorker('worker.js')
interface SharedWorker {
  port: { start: () => void; postMessage: (...args: any[]) => void }
}
type self = {
  onmessage: (e: { ports: port[] }) => void
}
```
